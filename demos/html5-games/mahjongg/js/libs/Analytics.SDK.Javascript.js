function G(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function Guid(){var e=(G()+G()+"-"+G()+"-"+G()+"-"+G()+"-"+G()+G()+G()).toUpperCase();return e}var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){"use strict";this._doesMapExist=!1;try{this._items=new Map,this._doesMapExist=!0}catch(e){console.log("AnalyticsMap ERROR: Map() is not supported"),this.items={}}}return e.prototype.has=function(e){"use strict";return this._doesMapExist?this._items.has(e):null!=this.items[e.toString()]},e.prototype.get=function(e){"use strict";return this._doesMapExist?this._items.get(e):this.items[e.toString()]},e.prototype.set=function(e,t){"use strict";this._doesMapExist?this._items.set(e,t):this.items[e.toString()]=t},e.prototype["delete"]=function(e){"use strict";return this._doesMapExist?this._items["delete"](e):delete this.items[e.toString()]},e.prototype.clear=function(){"use strict";this._doesMapExist?this._items.clear():this.items={}},e}();e.AnalyticsMap=t}(t=e.Tools||(e.Tools={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){this._date=new Date}return e.prototype.toString=function(){return this.toDateString(this._date)},e.prototype.format=function(e,t){for(var n=[],i=0;t>i;i++)n.push(0);var o=n.join("")+e;return o.substr(o.length-t,t)},e.prototype.toDateString=function(e){var t=1e3*(e.getTime()/1e3+60*-e.getTimezoneOffset()),n=new Date(t),i=Math.round(e.getTimezoneOffset()/60),o=Math.round((e.getTimezoneOffset()/60-i)/60),r=this.format(Math.abs(i),2)+":"+this.format(Math.abs(o),2);return(n.getUTCMonth()+1).toString()+"/"+n.getDate()+"/"+n.getFullYear()+" "+this.format(n.getUTCHours(),2)+":"+this.format(n.getUTCMinutes(),2)+":"+this.format(n.getSeconds(),2)+" "+(e.getTimezoneOffset()<0?"+":"-").toString()+r},Object.defineProperty(e,"Now",{get:function(){return new e},enumerable:!0,configurable:!0}),e}();e.DateTime=t}(t=e.Tools||(e.Tools={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e}();e.Application=t}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Undefined=0]="Undefined",e[e.Off=1]="Off",e[e.On=2]="On",e[e.OnCustom=3]="OnCustom"}(e.AudioState||(e.AudioState={}));e.AudioState}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Undefined=0]="Undefined",e[e.Easiest=1]="Easiest",e[e.Easier=2]="Easier",e[e.Normal=3]="Normal",e[e.Harder=4]="Harder",e[e.Hardest=5]="Hardest"}(e.DifficultyLevel||(e.DifficultyLevel={}));e.DifficultyLevel}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Undefined=0]="Undefined",e[e.Quit=1]="Quit",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed",e[e.Replay=4]="Replay"}(e.EndState||(e.EndState={}));e.EndState}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e}();e.EventMessage=t}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e}();e.EventMessageBatch=t}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Male=0]="Male",e[e.Female=1]="Female",e[e.Undefined=2]="Undefined"}(e.Gender||(e.Gender={}));e.Gender}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e}();e.Host=t}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Undefined=0]="Undefined",e[e.Mouse=1]="Mouse",e[e.Touch=2]="Touch",e[e.Keyboard=4]="Keyboard"}(e.InputState||(e.InputState={}));e.InputState}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.FacebookCredits=0]="FacebookCredits",e[e.SocialGold=1]="SocialGold",e[e.UltimatePay=2]="UltimatePay",e[e.SuperRewards=3]="SuperRewards",e[e.Cash=4]="Cash",e[e.Undefined=5]="Undefined"}(e.PaymentType||(e.PaymentType={}));e.PaymentType}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.None=0]="None",e[e.Landscape=1]="Landscape",e[e.Portrait=2]="Portrait",e[e.LandscapeFlipped=3]="LandscapeFlipped",e[e.PortraitFlipped=4]="PortraitFlipped"}(e.ScreenOrientation||(e.ScreenOrientation={}));e.ScreenOrientation}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Success=1]="Success",e[e.Cancel=2]="Cancel",e[e.FailTechnical=3]="FailTechnical",e[e.FailPayment=4]="FailPayment"}(e.TransactionResult||(e.TransactionResult={}));e.TransactionResult}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Invite=1]="Invite",e[e.Gift=2]="Gift",e[e.AskGift=3]="AskGift",e[e.Post=4]="Post",e[e.Message=5]="Message",e[e.Request=6]="Request",e[e.Count=7]="Count",e[e.News=8]="News",e[e.Ticker=9]="Ticker"}(e.ViralType||(e.ViralType={}));e.ViralType}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.FullScreenLandscape=0]="FullScreenLandscape",e[e.FullScreenPortrait=1]="FullScreenPortrait",e[e.Filled=2]="Filled",e[e.Snapped=3]="Snapped",e[e.Window=4]="Window",e[e.Undefined=5]="Undefined"}(e.WindowState||(e.WindowState={}));e.WindowState}(t=e.Model||(e.Model={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){this._totalMilliseconds=Math.floor(e)}return Object.defineProperty(e.prototype,"days",{get:function(){return Math.floor(this._totalMilliseconds/e.MILLISECONDS_IN_DAY)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hours",{get:function(){return Math.floor(this._totalMilliseconds/e.MILLISECONDS_IN_HOUR%24)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minutes",{get:function(){return Math.floor(this._totalMilliseconds/e.MILLISECONDS_IN_MINUTE%60)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seconds",{get:function(){return Math.floor(this._totalMilliseconds/e.MILLISECONDS_IN_SECOND%60)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"milliseconds",{get:function(){return Math.floor(this._totalMilliseconds%1e3)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalDays",{get:function(){return this._totalMilliseconds/e.MILLISECONDS_IN_DAY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalHours",{get:function(){return this._totalMilliseconds/e.MILLISECONDS_IN_HOUR},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalMinutes",{get:function(){return this._totalMilliseconds/e.MILLISECONDS_IN_MINUTE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalSeconds",{get:function(){return this._totalMilliseconds/e.MILLISECONDS_IN_SECOND},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalMilliseconds",{get:function(){return this._totalMilliseconds},enumerable:!0,configurable:!0}),e.createFromDates=function(t,n){return new e(n.getTime()-t.getTime())},e.createFromMilliseconds=function(t){return new e(t)},e.createFromSeconds=function(t){return new e(t*e.MILLISECONDS_IN_SECOND)},e.createFromMinutes=function(t){return new e(t*e.MILLISECONDS_IN_MINUTE)},e.createFromHours=function(t){return new e(t*e.MILLISECONDS_IN_HOUR)},e.createFromDays=function(t){return new e(t*e.MILLISECONDS_IN_DAY)},e.MILLISECONDS_IN_DAY=864e5,e.MILLISECONDS_IN_HOUR=36e5,e.MILLISECONDS_IN_MINUTE=6e4,e.MILLISECONDS_IN_SECOND=1e3,e}();e.TimeSpan=t}(t=e.Api||(e.Api={}))}(t=e.Core||(e.Core={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.Stats=new Object,this.GamePlayId=e,this.GameMode=t,this.GameSubMode=n}return e.prototype.Clone=function(){var t=new e(this.GamePlayId,this.GameMode,this.GameSubMode);t.Stats=new Object;for(var n in this.Stats)t.Stats[n]=this.Stats[n];return t},e}();e.GamePlayContext=t}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Started=0]="Started",e[e.Completed=1]="Completed",e[e.Canceled=2]="Canceled",e[e.Error=3]="Error"}(e.AsyncStatus||(e.AsyncStatus={}));e.AsyncStatus}(t=e.Api||(e.Api={}))}(t=e.Core||(e.Core={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e}();e.FileInfo=t}(t=e.Api||(e.Api={}))}(t=e.Core||(e.Core={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e}();e.SendResult=t}(t=e.Api||(e.Api={}))}(t=e.Core||(e.Core={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=4]="Warning",e[e.Error=8]="Error"}(e.LogLevel||(e.LogLevel={}));e.LogLevel}(t=e.Api||(e.Api={}))}(t=e.Core||(e.Core={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t){this.message=e,this.name=t}return e}();e.AnalyticsException=t}(t=e.Exceptions||(e.Exceptions={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);n.prototype=t.prototype,e.prototype=new n},Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(t,n){this._index=n,e.call(this,t,"EventCorruptedException")}return __extends(t,e),Object.defineProperty(t.prototype,"Index",{get:function(){return this._index},enumerable:!0,configurable:!0}),t}(e.AnalyticsException);e.EventCorruptedException=t}(t=e.Exceptions||(e.Exceptions={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(){e.call(this,"Can't send event(s) to the target server. Check your internet connection.","ServerConnectionException")}return __extends(t,e),t}(e.AnalyticsException);e.ServerConnectionException=t}(t=e.Exceptions||(e.Exceptions={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(){e.call(this,"Message can not be processed on the server.","ServerProcessingException")}return __extends(t,e),t}(e.AnalyticsException);e.ServerProcessingException=t}(t=e.Exceptions||(e.Exceptions={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(t){e.call(this,"File: "+t+" could not be found.","FileNotFoundException")}return __extends(t,e),t}(e.AnalyticsException);e.FileNotFoundException=t}(t=e.Exceptions||(e.Exceptions={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.Debug=function(){},e.prototype.Info=function(){},e.prototype.Warning=function(){},e.prototype.Error=function(){},e}();e.EmptyLogger=t}(t=e.Logging||(e.Logging={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,n){this._eventSender=n,this._fileSystem=e,this._fileName=t}return e.prototype.Send=function(e,t){this._eventSender.Send(e,t),this.SaveMessage(e)},e.prototype.SendBatch=function(e,t){this._eventSender.SendBatch(e,t);for(var n=0;n<e.EventMessages.length;n++){var i=e.EventMessages[n];this.SaveMessage(i)}},e.prototype.IsAvailable=function(e){this._eventSender.IsAvailable(e)},e.prototype.SaveMessage=function(e){var t=JSON.stringify(e);t+="\n",this._fileSystem.Save(this._fileName,t)},e}();e.DebugEventLogger=t}(t=e.Logging||(e.Logging={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n=(e.Connect.Analytics.SDK.Core.Api.AsyncStatus,e.Connect.Analytics.SDK.Impl.Logging.EmptyLogger),i=function(){function e(e,t){this._lockObject=new Object,this._status=0,this._action=e,this._logger=null!=t?t:new n}return e.prototype.Run=function(){try{this._status=0,this._action(),this._status=1}catch(e){this._errorCode=e,this._status=3}finally{this.CallCompleted()}},e.prototype.CallCompleted=function(){try{null!=this._completed&&(this._completed(this,this._status),this._completed=null)}catch(e){this._logger.Error("BackgroundAction Completed callback raised an error: "+e)}},e.prototype.Cancel=function(){this._status=2,this.CallCompleted()},e.prototype.Close=function(){},Object.defineProperty(e.prototype,"ErrorCode",{get:function(){return this._errorCode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Completed",{get:function(){return this._completed},set:function(e){this._completed=e,0!=this._status&&this.CallCompleted()},enumerable:!0,configurable:!0}),e}();t.BackgroundAction=i}(n=t.Background||(t.Background={}))}(n=t.Impl||(t.Impl={}))}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Core.Api.TimeSpan,i=(e.Connect.Analytics.SDK.Core.Api.AsyncStatus,e.Connect.Analytics.SDK.Impl.Logging.EmptyLogger),o=function(){function e(e,t){var o=this;if(this._waitDelay=n.createFromMilliseconds(10),this._actions=new Array,this._isDebugMode=e,this._logger=null!=t?t:new i,!this._isDebugMode){var r=this;setTimeout(function(){return o.RunProcess.call(r)},this._waitDelay)}}return Object.defineProperty(e.prototype,"IsDebugMode",{get:function(){return this._isDebugMode},set:function(e){this._isDebugMode=e},enumerable:!0,configurable:!0}),e.prototype.RunProcess=function(){var e=this;try{if(0==this._actions.length)return;var t=this.GetAction();this.Run(t)}catch(n){this._logger.Error("BackgroundWorker.RunProcess error: "+n)}finally{var i=this;setTimeout(function(){return e.RunProcess.call(i)},this._waitDelay)}},e.prototype.Run=function(e){null!=e&&2!=e.Status&&e.Run()},e.prototype.GetAction=function(){var e=this._actions.shift();return e},e.prototype.Invoke=function(e){var n=new t.BackgroundAction(e,this._logger);if(this._isDebugMode){if(n.Run(),3==n.Status)throw n.ErrorCode}else this._actions.push(n);return n},e}();t.BackgroundWorker=o}(n=t.Background||(t.Background={}))}(n=t.Impl||(t.Impl={}))}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n=(e.Connect.Analytics.SDK.Core.Api.AsyncStatus,function(){function e(e){this._logger=e}return e.prototype.Cancel=function(){},e.prototype.Close=function(){},Object.defineProperty(e.prototype,"ErrorCode",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Status",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Completed",{get:function(){return this._completed},set:function(e){this._completed=e,this.CallCompleted()},enumerable:!0,configurable:!0}),e.prototype.CallCompleted=function(){try{null!=this._completed&&(this._completed(this,this.Status),this._completed=null)}catch(e){this._logger.Error("BackgroundAction Completed callback raised an error: "+e)}},e}());t.SilentModeAction=n}(n=t.Background||(t.Background={}))}(n=t.Impl||(t.Impl={}))}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(e,t,n){this._dispatcher=e,this._environment=t,this._logger=n}return t.prototype.Invoke=function(t){return this._environment.SilentMode?(this._logger.Debug("Cancel dispatcher action, because SilentMode is enabled."),new e.SilentModeAction(this._logger)):(this._logger.Debug("Apply dispatcher action, because SilentMode is disabled."),this._dispatcher.Invoke(t))},t}();e.SilentModeKillSwitch=t}(t=e.Background||(e.Background={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){this._disposed=!1}return e.prototype.Init=function(e,t){var n=this,i=this,o=function(){n.NotDisposed()&&e.call(i,function(){setTimeout(o,t.totalMilliseconds)})};setTimeout(o,t.totalMilliseconds)},e.prototype.NotDisposed=function(){return!this._disposed},e.prototype.Dispose=function(){this._disposed=!0},e}();e.Timer=t}(t=e.Background||(e.Background={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,n){this.Id=e,this.Provider=t,this.Type=n}return e.prototype.Clone=function(){return new e(this.Id,this.Provider,this.Type)},e}();e.InventoryTransactionInfo=t}(t=e.Model||(e.Model={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,n,i){this.Key=e,this.Name=t,this.Type=n,this.Quantity=i}return e.prototype.Clone=function(){return new e(this.Key,this.Name,this.Type,this.Quantity)},e}();e.ItemInfo=t}(t=e.Model||(e.Model={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(t,n,i,o){void 0===o&&(o=e.DefaultCurrency),this.Price=t,this.Amount=n,this.TaxAmount=i,this.CurrencyCode=o}return e.prototype.Clone=function(){return new e(this.Price,this.Amount,this.TaxAmount,this.CurrencyCode)},e.DefaultCurrency="USD",e}();e.PriceInfo=t}(t=e.Model||(e.Model={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,n){this.Id=e,this.Provider=t,this.Result=n}return e.prototype.Clone=function(){return new e(this.Id,this.Provider,this.Result)},e}();e.TransactionInfo=t}(t=e.Model||(e.Model={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t){this.Id=e,this.Provider=t}return e}();e.UserIdentity=t}(t=e.Model||(e.Model={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Impl.Exceptions.EventCorruptedException,i=e.Connect.Analytics.SDK.Impl.Logging.EmptyLogger,o=e.Connect.Analytics.Tools.DateTime,r=function(){function e(e,t){this._logger=new i,this._filesQueue=new Array,this._logger=null!=t?t:new i,this._fileSystem=e;var n=this._fileSystem.ListFiles();n=n.sort(function(e,t){return e.CreationDate<t.CreationDate?-1:e.CreationDate>t.CreationDate?1:0});for(var o=new Array,r=0;r<n.length;r++){var a=n[r];o.push(a.Name)}this._filesQueue=o}return e.prototype.Enqueue=function(e){e.SentTime=o.Now.toString();var t=JSON.stringify(e),n=e.EventId+".json";this._fileSystem.Save(n,t),this._filesQueue.push(n)},e.prototype.Take=function(e){var t=this._filesQueue[e];return this.LoadMessage(t,e)},e.prototype.RemoveAt=function(e){var t=this._filesQueue,n=t[e];t=t.filter(function(t,n){return n!=e}),this._filesQueue=t,this._fileSystem.Delete(n)},e.prototype.Dequeue=function(){if(0==this._filesQueue.length)return null;var e=this._filesQueue.shift(),t=this.LoadMessage(e);return this._fileSystem.Delete(e),t},Object.defineProperty(e.prototype,"Count",{get:function(){return this._filesQueue.length},enumerable:!0,configurable:!0}),e.prototype.LoadMessage=function(e,t){void 0===t&&(t=0);var i=this._fileSystem.Load(e);try{return JSON.parse(i)}catch(o){throw this._logger.Warning("PersistentQueue.LoadMessage Can't load file: "+e+" because of: "+o),new n("Can't retrieve EventMessage."+o,t)}},e}();t.PersistentQueue=r}(n=t.Queue||(t.Queue={}))}(n=t.Impl||(t.Impl={}))}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Impl.Exceptions.AnalyticsException,i=function(){function e(){}return Object.defineProperty(e,"Track",{get:function(){return this.AssertInitialized(),this._trackingSubsystem.TrackingManager},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Environment",{get:function(){return this.AssertInitialized(),this._trackingSubsystem.Environment},enumerable:!0,configurable:!0}),e.AssertNotInitialized=function(){if(null!=this._trackingSubsystem)throw new n("Analytics is already initialized.","")},e.AssertInitialized=function(){if(null==this._trackingSubsystem)throw new n("Analytics is not initialized. Call TrackingManager.Initialize at first.","")},e.Initialize=function(n,i,o,r){void 0===i&&(i=null),void 0===o&&(o=null),void 0===r&&(r=null),e.AssertNotInitialized(),e._trackingSubsystem=new t.TrackingSubsystem,e._trackingSubsystem.Initialize(n,i,o,r)},e}();t.EventsBase=i}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){this._persistentQueue=e}return e.prototype.Enqueue=function(e){this._persistentQueue.Enqueue(e)},e.prototype.Take=function(e){return this._persistentQueue.Take(e)},e.prototype.RemoveAt=function(e){this._persistentQueue.RemoveAt(e)},e.prototype.Dequeue=function(){return this._persistentQueue.Dequeue()},Object.defineProperty(e.prototype,"Count",{get:function(){return this._persistentQueue.Count},enumerable:!0,configurable:!0}),e}();e.PersistentQueueProxy=t}(t=e.Queue||(e.Queue={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Impl.Logging.EmptyLogger,i=function(e){function t(t,i,o,r){e.call(this,t),this._environment=i,this._logger=r?r:new n,this._offlineMessagesCount=o.OfflineMessagesCount}return __extends(t,e),t.prototype.Enqueue=function(t){return this.Count>=this._offlineMessagesCount&&this._environment.IsOffline?void this._logger.Warning("Can't add more than "+this._offlineMessagesCount+" messages in offline mode"):void e.prototype.Enqueue.call(this,t)},t}(t.PersistentQueueProxy);t.LimitedQueue=i}(n=t.Queue||(t.Queue={}))}(n=t.Impl||(t.Impl={}))}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){this._eventMessages=new Array}return e.prototype.Enqueue=function(e){this._eventMessages.push(e)},e.prototype.Dequeue=function(){return this._eventMessages.shift()},e.prototype.Take=function(e){return this._eventMessages[e]},e.prototype.RemoveAt=function(e){var t=this._eventMessages;t=t.filter(function(t,n){return n!=e}),this._eventMessages=t},Object.defineProperty(e.prototype,"Count",{get:function(){return this._eventMessages.length},enumerable:!0,configurable:!0}),e}();e.MemoryQueue=t}(t=e.Queue||(e.Queue={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Impl.Exceptions.AnalyticsException,i=function(){function e(e,t){this._persistentMessages=e,this._notImportantMessages=t}return e.prototype.Enqueue=function(e){this._notImportantMessages.Enqueue(e)},e.prototype.Dequeue=function(){return this._persistentMessages.Count>0?this._persistentMessages.Dequeue():this._notImportantMessages.Count>0?this._notImportantMessages.Dequeue():null},e.prototype.Take=function(e){if(e<this._persistentMessages.Count)return this._persistentMessages.Take(e);if(e<this._persistentMessages.Count+this._notImportantMessages.Count){var t=e-this._persistentMessages.Count;return this._notImportantMessages.Take(t)}throw new n("Index out of the range of Queue","")},e.prototype.RemoveAt=function(e){if(e<this._persistentMessages.Count)this._persistentMessages.RemoveAt(e);else if(e<this._persistentMessages.Count+this._notImportantMessages.Count){var t=e-this._persistentMessages.Count-1;this._notImportantMessages.RemoveAt(t)}throw new n("Index out of the range of Queue","")},Object.defineProperty(e.prototype,"Count",{get:function(){return this._persistentMessages.Count+this._notImportantMessages.Count},enumerable:!0,configurable:!0}),e}();t.MixedQueue=i}(n=t.Queue||(t.Queue={}))}(n=t.Impl||(t.Impl={}))}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Impl.Exceptions.EventCorruptedException,i=e.Connect.Analytics.SDK.Impl.Exceptions.FileNotFoundException,o=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.Enqueue=function(t){e.prototype.Enqueue.call(this,t)},t.prototype.Dequeue=function(){if(0==this.Count)return null;try{return e.prototype.Dequeue.call(this)}catch(t){if(t instanceof n)throw t;if(t instanceof i)return e.prototype.RemoveAt.call(this,0),this.Dequeue()}return null},t.prototype.Take=function(t){try{return e.prototype.Take.call(this,t)}catch(o){if(o instanceof n)throw o;if(o instanceof i)return this.RemoveAt(0),this.Take(t)}return null},t.prototype.RemoveAt=function(t){try{e.prototype.RemoveAt.call(this,t)}catch(n){}},t}(t.PersistentQueueProxy);t.SafeQueue=o}(n=t.Queue||(t.Queue={}))}(n=t.Impl||(t.Impl={}))}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){this._queuedMessages=new Array,this._dequeueCount=0,this._persistentQueue=e}return e.prototype.Enqueue=function(e){this._queuedMessages.push(e)},e.prototype.Take=function(e){return this._persistentQueue.Take(e)},e.prototype.RemoveAt=function(e){this._persistentQueue.RemoveAt(e)},e.prototype.Dequeue=function(){if(this._dequeueCount>=this._persistentQueue.Count)return null;var e=this._persistentQueue.Take(this._dequeueCount);return this._dequeueCount+=1,e},Object.defineProperty(e.prototype,"Count",{get:function(){return this._persistentQueue.Count+this._queuedMessages.length-this._dequeueCount},enumerable:!0,configurable:!0}),e.prototype.Commit=function(){this.FlushEnqueueMessages(),this.FlushDequeueMessages()},e.prototype.FlushDequeueMessages=function(){for(var e=0;e<this._dequeueCount;e++)this._persistentQueue.Dequeue();
this._dequeueCount=0},e.prototype.FlushEnqueueMessages=function(){for(;0!=this._queuedMessages.length;){var e=this._queuedMessages.shift();this._persistentQueue.Enqueue(e)}},e.prototype.Rollback=function(){this._dequeueCount=0,this._queuedMessages=new Array},e}();e.TransactionalQueue=t}(t=e.Queue||(e.Queue={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Impl.Queue.TransactionalQueue,i=e.Connect.Analytics.SDK.Impl.Exceptions.ServerProcessingException,o=e.Connect.Analytics.SDK.Impl.Exceptions.ServerConnectionException,r=e.Connect.Analytics.SDK.Impl.Exceptions.EventCorruptedException,a=e.Connect.Analytics.SDK.Impl.Logging.EmptyLogger,s=e.Connect.Analytics.Model.EventMessageBatch,u=e.Connect.Analytics.Tools.DateTime,c=function(){function e(e,t,n,i,o){void 0===o&&(o=null),this._messagesToResend=new Array,this._persistentQueue=e,this._eventSender=t,this._environment=n,this._settings=i,this._logger=o?o:new a}return e.prototype.SendEvents=function(e){var t=this;if(this._environment.IsOffline)return void this._eventSender.IsAvailable(function(n){t._environment.IsOffline=!n,e()});var n=this._messagesToResend.length>0;return n?void this.TryResendMessages(e):0==this._persistentQueue.Count?void e():void(1==this._persistentQueue.Count?this.SendMessage(e):this.SendBatch(e))},e.prototype.TryResendMessages=function(e){for(var t=this;this._messagesToResend.length>0;){var n=this._messagesToResend.shift();this._eventSender.Send(n,function(n){n.Error&&t._logger.Warning("Can't re-send message to the analytics server, because: "+n.Error),0==t._messagesToResend.length&&e()})}},e.prototype.SendMessage=function(e){var t=this,a=new n(this._persistentQueue);try{var s=a.Dequeue();s.SentTime=u.Now.toString(),this._eventSender.Send(s,function(n){n.Error?n.Error instanceof i?(t._logger.Warning("Server can't process a message, will remove it. Details: "+n.Error),a.Commit()):n.Error instanceof o?(t._environment.IsOffline=!0,t._logger.Error("Can't send events because of event was corrupted. Details: "+n.Error),a.Rollback()):(t._logger.Error("Can't send events because of: "+n.Error),a.Rollback()):a.Commit(),e()})}catch(c){if(c instanceof r)throw this._logger.Error("Can't send events because of event was corrupted. Details: "+c),a.Rollback(),c;this._logger.Error("Can't send events because of: "+c),a.Rollback(),e()}},e.prototype.SendBatch=function(e){var t=this,a=new n(this._persistentQueue),s=null;try{if(s=this.GetMessagesBatch(a),0==s.EventMessages.length)return;this._eventSender.SendBatch(s,function(n){if(n.Error)if(n.Error instanceof i){if(t._logger.Warning("Server can't process some messages from batch, will try send them. Details: "+n.Error),null!=s&&null!=s.EventMessages&&0!=s.EventMessages.length)for(var r=0;r<s.EventMessages.length;r++){var u=s.EventMessages[r];t._messagesToResend.push(u)}a.Commit()}else n.Error instanceof o?(t._environment.IsOffline=!0,t._logger.Info("No access to server. Check your internet connection or server is down. Details: "+n.Error),a.Rollback()):(t._logger.Error("Can't send events because of: "+n.Error),a.Rollback());else{a.Commit(),t._logger.Info("Batch was sent successfully.");for(var r=0;r<s.EventMessages.length;r++){var u=s.EventMessages[r];t._logger.Info(u.toString())}}e()})}catch(u){if(u instanceof r)throw this._logger.Error("Can't send events because of event was corrupted. Details: "+u),a.Rollback(),u;this._logger.Error("Can't send events because of: "+u),a.Rollback(),e()}},e.prototype.GetMessagesBatch=function(e){var t=new s;t.EventMessages=new Array,t.SentTime=u.Now.toString();var n=null;do n=e.Dequeue(),null!=n&&(n.SentTime=u.Now.toString(),t.EventMessages.push(n));while(null!=n&&t.EventMessages.length<this._settings.BatchMessagesCount);return t},e}();t.QueueWorker=c}(n=t.Impl||(t.Impl={}))}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Impl.Queue.PersistentQueueProxy,i=e.Connect.Analytics.SDK.Impl.Exceptions.AnalyticsException,o=function(e){function t(t,n){e.call(this,t),this._settings=n}return __extends(t,e),t.prototype.AssertIsValid=function(e){this.AssertValidEventName(e.EventName),this.AssertValueLengthLimit("AppId",e.AppId),this.AssertValueLengthLimit("HostId",e.HostId),this.AssertValueLengthLimit("SDK",e.SDK),this.AssertValidPayloadValues(e.Payload)},t.prototype.AssertValidPayloadValue=function(e,t){this.AssertKeyNotNull(e),this.AssertKeyLengthLimit(e),this.AssertValueLengthLimit(e,t)},t.prototype.AssertKeyNotNull=function(e){if(null==e||0==e.length)throw new i("Key must not be null.","")},t.prototype.AssertKeyLengthLimit=function(e){if(e.length>this._settings.MaxPayloadKeyLength){var t="Key must be less than "+this._settings.MaxPayloadKeyLength+" characters.";throw new i(t,"")}},t.prototype.AssertValueLengthLimit=function(e,t){if(null!=t&&t.toString().length>this._settings.MaxPayloadValueLength){var n="Value for "+e+" must be less than "+this._settings.MaxPayloadValueLength+" characters.";throw new i(n,"")}},t.prototype.AssertValidPayloadValues=function(e){if(null!=e)for(var t in e)this.AssertValidPayloadValue(t,e[t])},t.prototype.AssertValidEventName=function(e){if(this.IsNullOrWhiteSpace(e))throw new i("EventName must not be null.","");if(e.length>this._settings.MaxEventNameLength){var t="Event names must be less than "+this._settings.MaxEventNameLength+" characters.";throw new i(t,"")}},t.prototype.IsNullOrWhiteSpace=function(e){return null==e||0===e.length||"string"==typeof e&&""==e.trim()},t}(n);t.ValidatorBase=o}(n=t.Validation||(t.Validation={}))}(n=t.Impl||(t.Impl={}))}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.Enqueue=function(t){this.AssertIsValid(t),e.prototype.Enqueue.call(this,t)},t}(e.ValidatorBase);e.BreakingValidationQueue=t}(t=e.Validation||(e.Validation={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Impl.Logging.EmptyLogger,i=function(e){function t(t,i,o){e.call(this,t,i),this._logger=o?o:new n}return __extends(t,e),t.prototype.Enqueue=function(t){try{this.AssertIsValid(t),e.prototype.Enqueue.call(this,t)}catch(n){this._logger.Error("Validation error: "+n)}},t}(t.ValidatorBase);t.SilentValidationQueue=i}(n=t.Validation||(t.Validation={}))}(n=t.Impl||(t.Impl={}))}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t){this._fileSystem=e,this._appId=t}return e.prototype.ListFiles=function(){var e=this,t=this._fileSystem.ListFiles(),n=t.filter(function(t){return t.Name.indexOf(e._appId)>=0});return n.forEach(function(t){t.Name=t.Name.replace(e._appId+"_","")}),n},e.prototype.Load=function(e){return this._fileSystem.Load(this._appId+"_"+e)},e.prototype.Save=function(e,t){this._fileSystem.Save(this._appId+"_"+e,t)},e.prototype.Delete=function(e){this._fileSystem.Delete(this._appId+"_"+e)},e}();e.FileSystemFilter=t}(t=e.FileSystem||(e.FileSystem={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Core.Api.TimeSpan,i=(e.Connect.Analytics.SDK.ValidationOptions,function(){function e(e,t,n,i,o,r){this._maxPayloadKeyLength=50,this._maxPayloadValueLength=255,this._maxEventNameLength=50,this._validationOptions=1,this._offlineMessagesCount=e,this._batchMessagesCount=t,this._flushTime=n,this._idleTimeout=i,this._validationOptions=o,this._deviceType=r}return Object.defineProperty(e.prototype,"MaxPayloadKeyLength",{get:function(){return this._maxPayloadKeyLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxPayloadValueLength",{get:function(){return this._maxPayloadValueLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxEventNameLength",{get:function(){return this._maxEventNameLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ValidationOptions",{get:function(){return this._validationOptions},set:function(e){this._validationOptions=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OfflineMessagesCount",{get:function(){return this._offlineMessagesCount},set:function(e){this._offlineMessagesCount=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BatchMessagesCount",{get:function(){return this._batchMessagesCount},set:function(e){this._batchMessagesCount=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FlushTime",{get:function(){return this._flushTime},set:function(e){this._flushTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IdleTimeout",{get:function(){return this._idleTimeout},set:function(e){this._idleTimeout=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DeviceType",{get:function(){return this._deviceType},set:function(e){this._deviceType=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Default",{get:function(){var t=new e(100,20,n.createFromSeconds(1),n.createFromMinutes(5),1,null);return t},enumerable:!0,configurable:!0}),e.prototype.toString=function(){var e="MaxPayloadKeyLength: "+this._maxPayloadKeyLength+"\n MaxPayloadValueLength: "+this._maxPayloadValueLength+"\n MaxEventNameLength: "+this._maxEventNameLength+"\n OfflineMessagesCount: "+this._offlineMessagesCount+"\n BatchMessagesCount: "+this._batchMessagesCount+"\n DeviceType: "+this._deviceType+"\n FlushTime: "+this._flushTime+"\n ValidationOptions: "+this._validationOptions;return e},e}());t.Settings=i}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Impl.QueueWorker,i=e.Connect.Analytics.SDK.Impl.Queue.MixedQueue,o=e.Connect.Analytics.Model.Gender,r=e.Connect.Analytics.Model.ViralType,a=e.Connect.Analytics.SDK.Impl.Model.InventoryTransactionInfo,s=e.Connect.Analytics.SDK.Impl.Logging.EmptyLogger,u=e.Connect.Analytics.SDK.Impl.Exceptions.EventCorruptedException,c=e.Connect.Analytics.SDK.Impl.Exceptions.AnalyticsException,l=e.Connect.Analytics.Model.EventMessage,d=e.Connect.Analytics.Tools.DateTime,f=function(){function e(e,t,o,r,a,u,c){void 0===c&&(c=null),this._lastEventTime=new Date,this._environment=e,this._persistentQueue=t,this._notImportantQueue=o,this._settings=u,this._logger=c?c:new s;var l=new i(this._persistentQueue,this._notImportantQueue);this._queueWorker=new n(l,r,e,u,this._logger),this._background=a}return Object.defineProperty(e.prototype,"LastEventTime",{get:function(){return this._lastEventTime},enumerable:!0,configurable:!0}),e.prototype.FlushEvents=function(e){try{this._queueWorker.SendEvents(e)}catch(t){t instanceof u&&(this._persistentQueue.RemoveAt(t.Index),this.Error(t.Message,t),this._logger.Error("Event corrupted."))}},e.prototype.BeginSession=function(e){var t=this;return void 0===e&&(e=null),this._background.Invoke(function(){var n=t.CreateEventMessage("BeginSession",e);t._persistentQueue.Enqueue(n)})},e.prototype.EndSession=function(e){var t=this;return void 0===e&&(e=null),this._background.Invoke(function(){var n=t.CreateEventMessage("EndSession",e);t._environment.SessionId=Guid().toString(),t._environment.StepNumber=0,t._environment.EventNumber=0,t._persistentQueue.Enqueue(n)})},e.prototype.BeginGamePlay=function(e,t,n,i,o,r){var a=this;return void 0===i&&(i=null),void 0===o&&(o=null),void 0===r&&(r=null),this._background.Invoke(function(){var s=a.CreateGamePlayContext(e,i,o);a._environment.SetGamePlayContext(s);var u=a.CreateEventMessage("BeginGamePlay",r,a._environment.GamePlayId);u.Payload.Level=t,u.Payload.IsReplay=n,a._persistentQueue.Enqueue(u);var c=a.GetCurrentGamePlayId(e);a.RemoveCounters(c)})},e.prototype.PauseGamePlay=function(e,t,n,i){var o=this;return void 0===i&&(i=null),this._background.Invoke(function(){var r=o.GetCurrentGamePlayId(e);o.AssertNotNull(r);var a=o.CreateEventMessage("PauseGamePlay",i,r);a.Payload.Level=t,a.Payload.Score=n,o.FillCountersTo(a,r),o._persistentQueue.Enqueue(a),o.RemoveCounters(r)})},e.prototype.ResumeGamePlay=function(e,t,n,i,o){var r=this;return void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),this._background.Invoke(function(){if(r.IsSpecified(e)){var a=r.CreateGamePlayContext(e,n,i);r._environment.SetGamePlayContext(a)}var s=r.GetCurrentGamePlayId(e);r.AssertNotNull(s);var u=r.CreateEventMessage("ResumeGamePlay",o,s);u.Payload.Level=t,r._persistentQueue.Enqueue(u),r.RemoveCounters(s)})},e.prototype.EndGamePlay=function(e,t,n,i,o){var r=this;return void 0===o&&(o=null),this._background.Invoke(function(){var a=r.GetCurrentGamePlayId(e);r.AssertNotNull(a);var s=r.CreateEventMessage("EndGamePlay",o,a);s.Payload.Level=t,s.Payload.Score=n,s.Payload.EndState=i.toString(),r.FillCountersTo(s,a),r._persistentQueue.Enqueue(s),r._environment.ClearGamePlayContext(a)})},e.prototype.IncreaseCounter=function(e,t,n){var i=this;return void 0===n&&(n=1),this._background.Invoke(function(){var o=i.GetCurrentGamePlayId(e);i.AssertNotNull(o,"Current gamePlayId could not detected. Please check that you specified valid GamePlayId or you have called BeginGamePlay before.");var r=i._environment.GetGamePlayContext(o);i.AssertGamePlayContextNotNull(r),i.IncreaseCounterStats(t,n,r)})},e.prototype.Purchase=function(e,t,n,i,o){var r=this;return void 0===i&&(i=null),void 0===o&&(o=null),this._background.Invoke(function(){var a=r.CreateEventMessage("Purchase",o);a.Payload.TransactionId=e.Id,a.Payload.TransactionProvider=e.Provider,a.Payload.TransactionResult=e.Result.toString(),a.Payload.ItemKey=t.Key,a.Payload.ItemName=t.Name,a.Payload.ItemType=t.Type,a.Payload.ItemQuantity=t.Quantity,a.Payload.Price=n.Price,a.Payload.Amount=n.Amount,a.Payload.TaxAmount=n.TaxAmount,n.CurrencyCode&&(a.Payload.CurrencyCode=n.CurrencyCode),a.Payload.Location=i,r._persistentQueue.Enqueue(a)})},e.prototype.PurchaseVirtual=function(e,t,n,i,o){var r=this;return void 0===i&&(i=null),void 0===o&&(o=null),this._background.Invoke(function(){var a=r.CreateEventMessage("PurchaseVirtual",o);a.Payload.TransactionId=e.Id,a.Payload.TransactionProvider=e.Provider,a.Payload.TransactionResult=e.Result.toString(),a.Payload.ItemKey=t.Key,a.Payload.ItemName=t.Name,a.Payload.ItemType=t.Type,a.Payload.ItemQuantity=t.Quantity,a.Payload.PaymentItemKey=n.Key,a.Payload.PaymentItemName=n.Name,a.Payload.PaymentItemType=n.Type,a.Payload.PaymentItemQuantity=n.Quantity,a.Payload.Location=i,r._persistentQueue.Enqueue(a)})},e.prototype.InventoryUpdate=function(e,t,n){var i=this;return void 0===t&&(t=null),void 0===n&&(n=null),this._background.Invoke(function(){var o=i.CreateEventMessage("InventoryUpdate",n);o.Payload.ItemKey=e.Key,o.Payload.ItemName=e.Name,o.Payload.ItemType=e.Type,o.Payload.ItemQuantity=e.Quantity,t=t?t:new a(null,null,null),o.Payload.TransactionId=t.Id,o.Payload.TransactionProvider=t.Provider,o.Payload.TransactionType=t.Type,i._persistentQueue.Enqueue(o)})},e.prototype.UserGender=function(e,t){var n=this;return void 0===t&&(t=null),this._background.Invoke(function(){var i=n.CreateEventMessage("UserGender",t);i.Payload.Gender=o[e],n._persistentQueue.Enqueue(i)})},e.prototype.UserDateOfBirth=function(e,t){var n=this;return void 0===t&&(t=null),this._background.Invoke(function(){var i=n.CreateEventMessage("UserDateOfBirth",t);i.Payload.DateOfBirth=e,n._persistentQueue.Enqueue(i)})},e.prototype.UserLocation=function(e,t){var n=this;return void 0===t&&(t=null),this._background.Invoke(function(){var i=n.CreateEventMessage("UserLocation",t);i.Payload.Location=e,n._persistentQueue.Enqueue(i)})},e.prototype.UserLocationByGPS=function(e,t,n,i){var o=this;return void 0===i&&(i=null),this._background.Invoke(function(){var r=o.CreateEventMessage("UserLocationByGPS",i);r.Payload.LocationLatitude=e,r.Payload.LocationLongitude=t,r.Payload.LocationAccuracy=n,o._persistentQueue.Enqueue(r)})},e.prototype.UserIdentity=function(e,t){var n=this;return void 0===t&&(t=null),this._background.Invoke(function(){var i=n.CreateEventMessage("UserIdentity",t);n.AssertUserNotNull(e),i.Payload.Identity=e.Id,i.Payload.IdentityProvider=e.Provider,n._persistentQueue.Enqueue(i)})},e.prototype.Ping=function(e){var t=this;return void 0===e&&(e=null),this._background.Invoke(function(){var n=t.CreateEventMessage("Ping",e);t._persistentQueue.Enqueue(n)})},e.prototype.Error=function(e,t,n){var i=this;return void 0===n&&(n=null),this._background.Invoke(function(){var o=i.CreateEventMessage("Error",n);o.Payload.Message=e,o.Payload.Exception=i.GetMessage(t),i._persistentQueue.Enqueue(o)})},e.prototype.CustomEvent=function(e,t,n){var i=this;return void 0===t&&(t=!0),void 0===n&&(n=null),this._background.Invoke(function(){var o=i.CreateEventMessage(e,n);t?i._persistentQueue.Enqueue(o):i._notImportantQueue.Enqueue(o)})},e.prototype.AwardEarned=function(e,t){var n=this;return void 0===t&&(t=null),this._background.Invoke(function(){var i=n.CreateEventMessage("AwardEarned",t);i.Payload.Award=e,n._persistentQueue.Enqueue(i)})},e.prototype.AdImpression=function(e,t,n,i){var o=this;return void 0===i&&(i=null),this._background.Invoke(function(){var r=o.CreateEventMessage("AdImpression",i);r.Payload.AdProvider=e,r.Payload.AdDimensions=t,r.Payload.Ad=n,o._persistentQueue.Enqueue(r)})},e.prototype.AdClick=function(e,t,n,i){var o=this;return void 0===i&&(i=null),this._background.Invoke(function(){var r=o.CreateEventMessage("AdClick",i);r.Payload.AdProvider=e,r.Payload.AdDimensions=t,r.Payload.Ad=n,o._persistentQueue.Enqueue(r)})},e.prototype.PageView=function(e,t,n){var i=this;return void 0===t&&(t=null),void 0===n&&(n=null),this._background.Invoke(function(){var o=i.CreateEventMessage("PageView",n);i.AssertPositive(t),o.Payload.PageName=e;var r=t?t:i._environment.StepNumber++;o.Payload.Step=r,i._persistentQueue.Enqueue(o)})},e.prototype.ViralRequest=function(e,t,n,i,o){var a=this;return void 0===i&&(i=null),void 0===o&&(o=null),this._background.Invoke(function(){var s=a.CreateEventMessage("ViralRequest",o);a.AssertNotEmpty(e),a.AssertValidEnum(t),s.Payload.ViralType=r[t],s.Payload.ViralItem=n,s.Payload.ViralRequestId=e.toString(),null!=i&&(s.Payload.SentUserId=i.Id,s.Payload.IdentityProvider=i.Provider),a._persistentQueue.Enqueue(s)})},e.prototype.ViralResponse=function(e,t,n,i){var o=this;return void 0===i&&(i=null),this._background.Invoke(function(){var a=o.CreateEventMessage("ViralResponse",i);o.AssertNotEmpty(e),o.AssertValidEnum(t),a.Payload.ViralType=r[t],a.Payload.ViralItem=n,a.Payload.ViralRequestId=e.toString(),o._persistentQueue.Enqueue(a)})},e.prototype.Activity=function(){var e=this;return this._background.Invoke(function(){e._lastEventTime=new Date})},e.prototype.AssertPositive=function(e){if("undefined"!=typeof e&&0>e)throw new c("Parameter must be positive or 0 (Zero).","")},e.prototype.CreateGamePlayContext=function(e,n,i){var o=e;return("undefined"==typeof e||""==e||this.IsNullOrWhiteSpace(e))&&(o=Guid()),new t.GamePlayContext(o,n,i)},e.prototype.GetMessage=function(e){if(!e)return null;var t=e.toString();return t.length>this._settings.MaxPayloadValueLength?t.substring(0,this._settings.MaxPayloadValueLength):t},e.prototype.CreateEventMessage=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this._logger.Debug("CreateEventMessage start");var i=new l;return i.EventName=e,i.EventId=Guid(),i.EventTime=d.Now.toString(),i.AppId=this._environment.AppId,i.HostId=this._environment.HostId,i.SDK=this._environment.SDK,this.FillPayload(i,t),this.FillGamePlayContext(i,n),this._lastEventTime=new Date,i},e.prototype.FillPayload=function(e,t){this._logger.Debug("FillPayload start"),e.Payload=t?this.ClonePayload(t):new Object,e.Payload.UserId=this._environment.UserId,e.Payload.DeviceId=this._environment.DeviceId,e.Payload.AppVersion=this._environment.AppVersion,e.Payload.AppInstanceId=this._environment.AppInstanceId,e.Payload.SessionId=this._environment.SessionId,e.Payload.IsOffline=this._environment.IsOffline,e.Payload.EventNumber=this._environment.EventNumber++},e.prototype.ClonePayload=function(e){var t=new Object;for(var n in e)t[n]=e[n];return t},e.prototype.FillGamePlayContext=function(e,t){this._logger.Debug("FillGamePlayContext start");var n=t?t:this._environment.GamePlayId;e.Payload.GamePlayId=n;var i=this._environment.GetGamePlayContext(n);return null==i?void this._logger.Debug("FillGamePlayContext context == null; return"):(null!=i.GameMode&&(e.Payload.GameMode=i.GameMode),void(null!=i.GameSubMode&&(e.Payload.GameSubMode=i.GameSubMode)))},e.prototype.IsNullOrWhiteSpace=function(e){return"string"==typeof e&&""==e.trim()?!1:null==e||0===e.length},e.prototype.AssertNotNull=function(e,t){void 0===t&&(t=null);var n="GamePlayId must be specified for this method. Make sure that you specified GamePlayId for this method or method BeginGamePlay was called before this method.";if(null==e||0===e.length||0==e.trim().length){var i=t?t:n;throw new c(i,"")}},e.prototype.AssertUserNotNull=function(e){if(!e)throw new c("User identity should be specified.","")},e.prototype.AssertValidEnum=function(e){if(!e||!r[e]||0/0==Number(e)){var t=new Array;for(var n in r)if(!parseInt(n)){var i=r[n];t.push(n+"="+i)}throw new c("Parameter must have the following values: "+t.join(),"ArgumentOutOfRange")}},e.prototype.AssertNotEmpty=function(e){if(null==e||0===e.length)throw new c("Parameter must be valid, not empty GUID.","")},e.prototype.GetCurrentGamePlayId=function(e){var t=this._environment.GamePlayId;return this.IsSpecified(e)&&(t=e),t},e.prototype.IsSpecified=function(e){return!(null==e||0===e.length)},e.prototype.FillCountersTo=function(e,t){var n=this._environment.GetGamePlayContext(t);if(null!=n)for(var i in n.Stats)e.Payload[i]=n.Stats[i]},e.prototype.IncreaseCounterStats=function(e,t,n){n.Stats.hasOwnProperty(e)||(n.Stats[e]=0),n.Stats[e]+=t},e.prototype.RemoveCounters=function(e){var t=this._environment.GetGamePlayContext(e);null!=t&&(t.Stats=new Object)},e.prototype.AssertGamePlayContextNotNull=function(e){if(!e)throw new c("GamePlayContext for the specified gamePlayId could not be found. Please check you called BeginGamePlay or ResumeGamePlay before.","")},e}();t.TrackingManager=f}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Impl.Queue.PersistentQueue,i=e.Connect.Analytics.SDK.Impl.Queue.LimitedQueue,o=e.Connect.Analytics.SDK.Impl.Queue.MemoryQueue,r=e.Connect.Analytics.SDK.Impl.Background.SilentModeKillSwitch,a=e.Connect.Analytics.SDK.Impl.Validation.SilentValidationQueue,s=e.Connect.Analytics.SDK.Impl.Validation.BreakingValidationQueue,u=e.Connect.Analytics.SDK.Impl.Logging.EmptyLogger,c=e.Connect.Analytics.SDK.Impl.Exceptions.AnalyticsException,l=e.Connect.Analytics.SDK.Impl.FileSystem.FileSystemFilter,d=e.Connect.Analytics.SDK.Impl.Queue.SafeQueue,f=function(){function e(){this._logger=new u,this._components=new Array}return Object.defineProperty(e.prototype,"TrackingManager",{get:function(){return this.AssertInitialized(),this._trackingManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Environment",{get:function(){return this.AssertInitialized(),this._environment},enumerable:!0,configurable:!0}),e.prototype.Initialize=function(e,n,i,o){void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),this._logger=o?o:new u,this._logger.Debug("Starting initialization of the TrackingSubsystem ---------------------------------------------------------- "),this.AssertNotInitialized(),this._settings=n?n:t.Settings.Default,this._logger.Debug("TrackingSubsystem.Settings: \n "+this._settings);var a=2==this._settings.ValidationOptions;this._logger.Debug("Initialize.IsDebug: "+a),this._environment=e.CreateEnvironment(),this._logger.Debug("Environment.SDK: "+this._environment.SDK),this._logger.Debug("Initialize.Environment created successfully.");var s=new l(e.CreateFileSystem(),this._environment.AppId);this._logger.Debug("Initialize.FileSystem created successfully.");var c=this.CreatePersistentQueue(s,this._environment,this._settings),d=this.CreateNotImportantQueue(this._environment,this._settings),f=e.CreateEventSender();this._logger.Debug("Initialize.EventSender created successfully.");var p=e.CreateDispatcher();p=new r(p,this._environment,this._logger),this._logger.Debug("Initialize.Dispatcher created successfully."),this._trackingManager=new t.TrackingManager(this._environment,c,d,f,p,this._settings,this._logger),this._logger.Debug("Initialize.TrackingManager created successfully."),this.InitializeComponents(i),this._logger.Debug("Initialization process is finished successfully ------------------------------------------------------------"),this._logger.Info("SDK "+this._environment.SDK+" was initialized:"),this._logger.Info("Settings: \n "+this._settings.toString())},e.prototype.InitializeComponents=function(e){try{if(this._logger.Debug("InitializeComponents Started."),null!=e)for(var t=0;t<e.length;t++)this._components.push(e[t]);for(var n=0;n<this._components.length;n++){var i=this._components[n];this._logger.Info("Initializing component: "+i),i.Initialize(this._trackingManager)}}catch(o){this._logger.Error("Can't initialize components. Because of: "+o)}},e.prototype.CreatePersistentQueue=function(e,t,o){var r=new n(e,this._logger);this._logger.Debug("Initialize PersistentQueue created successfully");var a=new d(r);this._logger.Debug("Initialize Safe queue created successfully"),r=this.GetValidationQueue(a,o);var s=new i(r,t,o,this._logger);return this._logger.Debug("Initialize LimitedQueue created successfully"),s},e.prototype.CreateNotImportantQueue=function(e,t){var n=new o;this._logger.Debug("Initialize PersistentQueue created successfully"),n=this.GetValidationQueue(n,t);var r=new i(n,e,t,this._logger);return this._logger.Debug("Initialize LimitedQueue created successfully"),r},e.prototype.GetValidationQueue=function(e,t){switch(t.ValidationOptions){case 1:return this._logger.Debug("Initialize SilentValidationQueue creating..."),new a(e,t,this._logger);case 2:return this._logger.Debug("Initialize BreakingValidationQueue creating..."),new s(e,t);default:return this._logger.Warning("Initialize Validation option is not recognized. PQ not will not validate saving messages."),e}},e.prototype.AssertNotInitialized=function(){if(null!=this._trackingManager)throw new c("Analytics is already initialized.","")},e.prototype.AssertInitialized=function(){if(null==this._trackingManager)throw new c("Analytics is not initialized. Call TrackingManager.Initialize at first.","")},e}();t.TrackingSubsystem=f}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Silent=1]="Silent",e[e.RaiseErrors=2]="RaiseErrors"}(e.ValidationOptions||(e.ValidationOptions={}));e.ValidationOptions}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.Model.WindowState,i=e.Connect.Analytics.Model.InputState,o=e.Connect.Analytics.Model.ScreenOrientation,r=function(){function e(e,t){this.Name=e,this.Value=t}return e}();t.PropertyInfo=r;var a=function(){function e(e,t,n,i,o){this.STRING_EMPTY="",this._properties=new Object,this.EnvironmentChanged="EnvironmentChanged",this._period=n,this._environment=e,this._logger=o,this._timer=t,this.definePropertiesToTrack(i),this.rememberCurrentStateOf(this._environment)}return e.prototype.definePropertiesToTrack=function(e){if(this._properties.WindowState=this.STRING_EMPTY,this._properties.InputState=this.STRING_EMPTY,this._properties.ScreenResolution=this.STRING_EMPTY,this._properties.ScreenOrientation=this.STRING_EMPTY,this._properties.Locale=this.STRING_EMPTY,this._properties.DeviceOS=this.STRING_EMPTY,this._properties.DeviceModel=this.STRING_EMPTY,this._properties.DeviceType=this.STRING_EMPTY,this._properties.Browser=this.STRING_EMPTY,null!=e)for(var t=0;t<e.length;t++){var n=e[t];this._properties[n]=this.STRING_EMPTY}},e.prototype.Initialize=function(t){var n=this;this._track=t,this._timer.Init(function(e){return n.TrackChanges(e)},this._period);var i=sessionStorage.getItem(e.InitializedKey);i||(this.TrackInitialState(),sessionStorage.setItem(e.InitializedKey,(!0).toString()))},e.prototype.TrackInitialState=function(){var e=new Object;for(var t in this._properties){var n=this._properties[t];e[t]=n}this._track.CustomEvent(this.EnvironmentChanged,!0,e)},e.prototype.rememberCurrentStateOf=function(e){for(var t in this._properties){var n=this.GetValue(e,t);this._properties[t]=n}},e.prototype.GetValue=function(e,t){var r=e[t];return"InputState"==t?this.StringifyFlag(r,i):"WindowState"==t?this.StringifyFlag(r,n):"ScreenOrientation"==t?this.StringifyFlag(r,o):null!=r?r.toString():this.STRING_EMPTY},e.prototype.StringifyFlag=function(e,t){if(t[e])return t[e];var n=Array(),i=new Array;for(var o in t)parseInt(o)&&i.push(parseInt(o));for(var r=0;r<i.length;r++){var a=i[r];(e&a)==a&&n.push(t[a])}return n.join("|")},e.prototype.GetProperties=function(e){var t=new Array;for(var n in this._properties)t.push(new r(n,e[n]));return t},e.prototype.TrackChanges=function(e){try{var t=this.GetChangesOf(this._environment);this.GetSize(t)>0&&(this._track.CustomEvent("EnvironmentChanged",!0,t),this.rememberCurrentStateOf(this._environment))}catch(n){this._logger.Error("Culd not track changes because of: "+n)}finally{e()}},e.prototype.GetSize=function(e){var t=0;for(var n in e)t+=1;return t},e.prototype.GetChangesOf=function(e){for(var t=new Object,n=this.GetProperties(e),i=0;i<n.length;i++){var o=n[i],r=this._properties[o.Name],a=this.GetValue(e,o.Name);r!=a&&(t[o.Name]=a)}return t},e.InitializedKey="ADAPT_EnvironmentWatcher_Initialized",e}();t.EnvironmentWatcher=a}(n=t.Components||(t.Components={}))}(n=t.Impl||(t.Impl={}))}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,n){this._logger=n,this._settings=e,this._timer=t}return e.prototype.Initialize=function(e){this._track=e,this.StartAutoFlushEvents()},e.prototype.StartAutoFlushEvents=function(){var e=this,t=this;this._timer.Init(function(n){return e.AutoFlushEvents.call(t,n)},this._settings.FlushTime)},e.prototype.AutoFlushEvents=function(e){try{this._track.FlushEvents(e)}catch(t){this._logger.Error("AutoFlushEvents could not be completed, because of : "+t),e()}},e}();e.EventsFlushWorker=t}(t=e.Components||(e.Components={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))
}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Core.Api.TimeSpan,i=function(){function e(e,t,i){this._noNeedToWork=n.createFromMilliseconds(0),this._checkingTimeout=n.createFromSeconds(1),this._idleTimeout=e,this._timer=t,this._logger=i}return e.prototype.Initialize=function(e){var t=this;if(this._trackingManager=e,this._idleTimeout.totalMilliseconds!=this._noNeedToWork.totalMilliseconds){var n=this;this._timer.Init(function(e){return t.Beat.call(n,e)},this._checkingTimeout)}},e.prototype.Beat=function(e){try{var t=(new Date).getTime()-this._trackingManager.LastEventTime.getTime();if(t>this._idleTimeout.totalMilliseconds){var n=new Object;n.IdleTimeout=this._idleTimeout.totalSeconds,this._trackingManager.CustomEvent("Idle",!0,n)}}catch(i){this._logger.Error("Cant process beat, because of: "+i)}finally{e()}},e.prototype.Dispose=function(){this._timer.Dispose()},e}();t.IdleDetectionWorker=i}(n=t.Components||(t.Components={}))}(n=t.Impl||(t.Impl={}))}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){this._jqueryInstance=e}return e.prototype.Initialize=function(e){this._track=e;var t=this;this._jqueryInstance(window).on("click",function(){return t.TrackActivity.call(t)}),this._jqueryInstance(window).on("touchstart",function(){return t.TrackActivity.call(t)})},e.prototype.TrackActivity=function(){this._track.Activity()},e}();e.UserActivityWatcher=t}(t=e.Components||(e.Components={}))}(t=e.Impl||(e.Impl={}))}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Core.Api.FileInfo,i=e.Connect.Analytics.SDK.Impl.Exceptions.FileNotFoundException,o=function(){function e(e){this._storage=e}return e.prototype.ListFiles=function(){for(var e=new Array,t=this._storage.GetKeys(),i=0;i<t.length;i++){var o=new n;o.CreationDate=new Date,o.Name=t[i],e.push(o)}return e},e.prototype.Load=function(e){this.AssertFileExists(e);var t=this._storage.GetItem(e);return t},e.prototype.Save=function(e,t){var i=new n;i.Name=e,i.CreationDate=new Date,this._storage.SetItem(e,t)},e.prototype.Delete=function(e){this.AssertFileExists(e),this._storage.RemoveItem(e)},e.prototype.AssertFileExists=function(e){var t=this._storage.GetKeys().filter(function(t){return t==e});if(0==t.length)throw new i(e)},e}();t.BrowserStorage=o}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Core.Api.SendResult,i=e.Connect.Analytics.SDK.Impl.Exceptions.ServerProcessingException,o=e.Connect.Analytics.SDK.Impl.Exceptions.ServerConnectionException,r=function(){function e(e,t){this.MediaType="?format=json",this.RequestTrackUri="api/event/track",this.RequestBatchUri="api/event/batch",this.RequestPingUri="api/event/ping",this._baseAddress=e,this._jQueryInstance=t}return e.prototype.Send=function(e,t){this._jQueryInstance.ajax({crossDomain:!0,type:"POST",data:JSON.stringify(e),url:this._baseAddress+"/"+this.RequestTrackUri+this.MediaType,success:function(){t(new n)},error:function(e){var r=new n;r.Error=400==e.status?new i:500==e.status?new i:new o,t(r)}})},e.prototype.SendBatch=function(e,t){this._jQueryInstance.ajax({crossDomain:!0,type:"POST",data:JSON.stringify(e),url:this._baseAddress+"/"+this.RequestBatchUri+this.MediaType,success:function(){t(new n)},error:function(e){var r=new n;r.Error=400==e.status?new i:500==e.status?new i:new o,t(r)}})},e.prototype.IsAvailable=function(e){this._jQueryInstance.ajax({crossDomain:!0,type:"GET",url:this._baseAddress+"/"+this.RequestPingUri,success:function(){e(!0)},error:function(){e(!1)}})},e}();t.BrowserEventSender=r}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n=(e.Connect.Analytics.Model.WindowState,e.Connect.Analytics.Model.InputState,e.Connect.Analytics.Model.ScreenOrientation,e.Connect.Analytics.Tools.AnalyticsMap),i=function(){function e(e,t,i,o,r,a,s){this._gameplays=new n,this._sessionStorage=e,this._persistentStorage=t,this._settings=s,this._appId=i,this._hostId=o,this._appVersion=r,this._detect=a,this._appInstanceId=Guid(),this._deviceId=this.GetPersistentGuid("ADAPT_DeviceId"),this._userId=this.GetPersistentGuid("ADAPT_UserId"),this._deviceTypeOld=this.getDeviceType(),this._isOffline=!1,isNaN(this.EventNumber)&&(this.EventNumber=0),isNaN(this.StepNumber)&&(this.StepNumber=0),this._sdk="Arkadium.Connect.Analytics.SDK.Javascript v.1.4.0.2";var u=this._detect.parse(navigator.userAgent);this._os=u.os.family,this._model=u.device.name,this._browser=u.browser.name,this._deviceType=u.device.type,this._settings.DeviceType&&(this._deviceType=this._settings.DeviceType)}return e.prototype.GetPersistentGuid=function(e){var t=this._persistentStorage.GetItem(e);return null==t&&(t=Guid().toString(),this._persistentStorage.SetItem(e,t)),t.toString()},Object.defineProperty(e.prototype,"WindowState",{get:function(){return 4},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"InputState",{get:function(){var e=0;return e|=this.hasTouchScreen()?2:0,e|=this.hasKeyboard()?4:0,e|=this.hasMouse()?1:0},enumerable:!0,configurable:!0}),e.prototype.hasKeyboard=function(){var e=this._deviceTypeOld;return"pc"==e?!0:!1},e.prototype.hasMouse=function(){var e=this._deviceTypeOld;return"pc"==e?!0:!1},e.prototype.isAndroid=function(){return navigator.userAgent.match(/Android/i)&&!navigator.userAgent.match(/Trident/i)?!0:!1},e.prototype.getDeviceType=function(){var e=navigator.userAgent||navigator.vendor||window.opera,t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e),n=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4));return t||n?"phone":this.isAndroid()||e.match(/mobile/i)?"tablet":"pc"},e.prototype.hasTouchScreen=function(){if("number"==typeof window.navigator.msMaxTouchPoints)return window.navigator.msMaxTouchPoints>0;var e=window.navigator&&window.navigator.msPointerEnabled&&window.MSGesture;return"ontouchstart"in window||e||window.DocumentTouch&&window.document instanceof window.DocumentTouch},Object.defineProperty(e.prototype,"ScreenResolution",{get:function(){var e=window.devicePixelRatio||(window.screen.deviceXDPI&&window.screen.logicalXDPI?window.screen.deviceXDPI/window.screen.logicalXDPI:1),t=window.innerWidth*e,n=window.innerHeight*e;return t+"x"+n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ScreenOrientation",{get:function(){return window.innerWidth>window.innerHeight?1:2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Locale",{get:function(){return window.navigator.userLanguage||window.navigator.language},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AppVersion",{get:function(){return this._appVersion},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DeviceId",{get:function(){return this._deviceId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DeviceOS",{get:function(){return this._os},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DeviceModel",{get:function(){return this._model},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DeviceType",{get:function(){return this._deviceType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Browser",{get:function(){return this._browser},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UserId",{get:function(){return this._userId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SDK",{get:function(){return this._sdk},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsOffline",{get:function(){return this._isOffline},set:function(e){this._isOffline=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AppId",{get:function(){return this._appId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HostId",{get:function(){return this._hostId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AppInstanceId",{get:function(){return this._appInstanceId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SessionId",{get:function(){var e=this._sessionStorage.GetItem("ADAPT_SessionId");return e||(e=Guid().toString(),this._sessionStorage.SetItem("ADAPT_SessionId",e)),e},set:function(e){this._sessionStorage.SetItem("ADAPT_SessionId",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"StepNumber",{get:function(){return Number(this._sessionStorage.GetItem("ADAPT_StepNumber"))},set:function(e){this._sessionStorage.SetItem("ADAPT_StepNumber",e.toString())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EventNumber",{get:function(){return Number(this._sessionStorage.GetItem("ADAPT_EventNumber"))},set:function(e){this._sessionStorage.SetItem("ADAPT_EventNumber",e.toString())},enumerable:!0,configurable:!0}),e.prototype.SetGamePlayContext=function(e){this.GamePlayId=e.GamePlayId,this._gameplays.has(this.GamePlayId)||this._gameplays.set(this.GamePlayId,e)},e.prototype.GetGamePlayContext=function(e){var t=e?e:this.GamePlayId;return null!=t?this.GetGamePlay(t):null},e.prototype.GetGamePlay=function(e){var t;return this._gameplays.has(e)&&(t=this._gameplays.get(e)),t},e.prototype.ClearGamePlayContext=function(e){this.GamePlayId==e&&(this.GamePlayId=null),null!=e&&this._gameplays["delete"](e)},e}();t.BrowserEnvironment=i}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Impl.Background.BackgroundWorker,i=function(){function e(e,t,i,o,r,a,s,u,c){this._dispatcher=new n(o,s),this._serverUrl=r,this._appId=e,this._hostId=t,this._appVersion=i,this._jquery=a,this._detect=u,this._settings=c}return e.prototype.CreateEventSender=function(){return new t.BrowserEventSender(this._serverUrl,this._jquery)},e.prototype.CreateEnvironment=function(){return new t.BrowserEnvironment(new t.BrowserSessionStorage,new t.BrowserLocalStorage,this._appId,this._hostId,this._appVersion,this._detect,this._settings)},e.prototype.CreateFileSystem=function(){return new t.BrowserStorage(new t.BrowserLocalStorage)},e.prototype.CreateDispatcher=function(){return this._dispatcher},e}();t.BrowserFactory=i}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n=e.Connect.Analytics.SDK.Core.Api.TimeSpan,i=e.Connect.Analytics.SDK.Impl.Background.Timer,o=e.Connect.Analytics.SDK.Impl.Components.EnvironmentWatcher,r=e.Connect.Analytics.SDK.Impl.Components.EventsFlushWorker,a=e.Connect.Analytics.SDK.Impl.Components.IdleDetectionWorker,s=e.Connect.Analytics.SDK.Impl.Components.UserActivityWatcher,u=function(){function e(){}return Object.defineProperty(e,"Track",{get:function(){return t.EventsBase.Track},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Environment",{get:function(){return t.EventsBase.Environment},enumerable:!0,configurable:!0}),e.Initialize=function(e,u,c,l,d,f,p,h){var v=2==d.ValidationOptions,m=new t.BrowserFactory(e,u,c,v,l,f,p,h,d),y=new Array;y.push(new o(m.CreateEnvironment(),new i,n.createFromSeconds(1),[],p)),y.push(new r(d,new i,p)),y.push(new a(d.IdleTimeout,new i,p)),y.push(new s(f)),t.EventsBase.Initialize(m,d,y,p)},e}();t.Events=u}(n=t.SDK||(t.SDK={}))}(n=t.Analytics||(t.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.GetKeys=function(){var e=new Array;for(var t in localStorage)e.push(t);return e},e.prototype.GetItem=function(e){return localStorage.getItem(e)},e.prototype.SetItem=function(e,t){localStorage.setItem(e,t)},e.prototype.RemoveItem=function(e){localStorage.removeItem(e)},e}();e.BrowserLocalStorage=t}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));var Arkadium;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.GetKeys=function(){var e=new Array;for(var t in sessionStorage)e.push(t);return e},e.prototype.GetItem=function(e){return sessionStorage.getItem(e)},e.prototype.SetItem=function(e,t){sessionStorage.setItem(e,t)},e.prototype.RemoveItem=function(e){sessionStorage.removeItem(e)},e}();e.BrowserSessionStorage=t}(t=e.SDK||(e.SDK={}))}(t=e.Analytics||(e.Analytics={}))}(t=e.Connect||(e.Connect={}))}(Arkadium||(Arkadium={}));